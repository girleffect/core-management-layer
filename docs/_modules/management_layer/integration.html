

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>management_layer.integration &mdash; Girl Effect: Core management layer  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Girl Effect: Core management layer
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Girl Effect: Core management layer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>management_layer.integration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for management_layer.integration</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">uuid</span>

<span class="kn">from</span> <span class="nn">management_layer.api.stubs</span> <span class="k">import</span> <span class="n">AbstractStubClass</span>
<span class="kn">from</span> <span class="nn">management_layer.exceptions</span> <span class="k">import</span> <span class="n">JSONBadRequest</span><span class="p">,</span> <span class="n">JSONForbidden</span><span class="p">,</span> <span class="n">JSONNotFound</span>
<span class="kn">from</span> <span class="nn">management_layer</span> <span class="k">import</span> <span class="n">transformations</span><span class="p">,</span> <span class="n">mappings</span><span class="p">,</span> <span class="n">__version__</span><span class="p">,</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">management_layer.constants</span> <span class="k">import</span> <span class="n">TECH_ADMIN_ROLE_LABEL</span>
<span class="kn">from</span> <span class="nn">management_layer.permission</span> <span class="k">import</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">management_layer.permission.decorator</span> <span class="k">import</span> <span class="n">require_permissions</span><span class="p">,</span> <span class="n">requester_has_role</span>
<span class="kn">from</span> <span class="nn">management_layer.settings</span> <span class="k">import</span> <span class="n">MANAGEMENT_PORTAL_CLIENT_ID</span>
<span class="kn">from</span> <span class="nn">management_layer.utils</span> <span class="k">import</span> <span class="n">client_exception_handler</span><span class="p">,</span> <span class="n">transform_users_with_roles</span>

<span class="n">TOTAL_COUNT_HEADER</span> <span class="o">=</span> <span class="s2">&quot;X-Total-Count&quot;</span>
<span class="n">CLIENT_TOTAL_COUNT_HEADER</span> <span class="o">=</span> <span class="s2">&quot;X-Total-Count&quot;</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="Implementation"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation">[docs]</a><span class="k">class</span> <span class="nc">Implementation</span><span class="p">(</span><span class="n">AbstractStubClass</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The implementation linking calls made the Management Layer</span>
<span class="sd">    to the Authentication-, Access Control- and User Data Store services.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># adminnote_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.adminnote_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.adminnote_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:adminnote&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span>
                         <span class="n">target_user_field</span><span class="o">=</span><span class="s2">&quot;creator_id&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">adminnote_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param user_id (optional): string An optional query parameter to filter by user_id</span>
<span class="sd">        :param creator_id (optional): string An optional query parameter to filter by creator (a user_id)</span>
<span class="sd">        :param admin_note_ids (optional): array An optional list of adminnote ids</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">admin_notes</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">adminnote_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">admin_notes</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ADMIN_NOTE</span>
            <span class="n">admin_notes</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">admin_notes</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">admin_notes</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># adminnote_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.adminnote_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.adminnote_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:adminnote&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">adminnote_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The caller of this function is considered the creator.</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;creator_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">][</span><span class="s2">&quot;sub&quot;</span><span class="p">]</span>

        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">admin_note</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">adminnote_create</span><span class="p">(</span><span class="n">admin_note_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">admin_note</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ADMIN_NOTE</span>
            <span class="k">return</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">admin_note</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># adminnote_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.adminnote_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.adminnote_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:adminnote&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">adminnote_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">admin_note_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param admin_note_id: integer A unique integer value identifying the admin note.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">adminnote_delete</span><span class="p">(</span><span class="n">admin_note_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># adminnote_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.adminnote_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.adminnote_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:adminnote&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">adminnote_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">admin_note_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param admin_note_id: integer A unique integer value identifying the admin note.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">admin_note</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">adminnote_read</span><span class="p">(</span><span class="n">admin_note_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">admin_note</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ADMIN_NOTE</span>
            <span class="k">return</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">admin_note</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># adminnote_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.adminnote_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.adminnote_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:adminnote&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">adminnote_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">admin_note_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param admin_note_id: integer A unique integer value identifying the admin note.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">admin_note</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">adminnote_update</span><span class="p">(</span><span class="n">admin_note_id</span><span class="p">,</span>
                                                                             <span class="n">admin_note_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">admin_note</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ADMIN_NOTE</span>
            <span class="k">return</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">admin_note</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># client_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.client_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.client_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:identity_provider:oidc_provider:client&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">client_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param client_ids (optional): array An optional list of client ids</span>
<span class="sd">        :param client_token_id (optional): string An optional client id to filter on. This is not the primary key.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">clients</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">client_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">clients</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">CLIENT</span>
            <span class="n">clients</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">client</span> <span class="ow">in</span> <span class="n">clients</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">clients</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># client_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.client_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.client_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:identity_provider:oidc_provider:client&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">client_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param client_id: integer A integer identifying the client</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">client</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">client_read</span><span class="p">(</span><span class="n">client_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">client</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">CLIENT</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># country_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.country_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.country_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="c1"># No permissions are required for this</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">country_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param country_codes (optional): array An optional list of country codes</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">countries</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">country_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">countries</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">COUNTRY</span>
            <span class="n">countries</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">country</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">countries</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">countries</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># country_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.country_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.country_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="c1"># No permissions are required for this</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">country_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">country_code</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param country_code: string A unique two-character value identifying the country.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">country</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">country_read</span><span class="p">(</span><span class="n">country_code</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">country</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">COUNTRY</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">country</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># deleteduser_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.deleteduser_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.deleteduser_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:deleteduser&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">deleteduser_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param deleter_id (optional): string An optional query parameter to filter by deleter_id</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">deleted_users</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deleteduser_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deleted_users</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DELETED_USER</span>
            <span class="n">deleted_users</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">deleted_user</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
                             <span class="k">for</span> <span class="n">deleted_user</span> <span class="ow">in</span> <span class="n">deleted_users</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">deleted_users</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># deleteduser_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.deleteduser_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.deleteduser_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:deleteduser&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">deleteduser_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The caller of this function is considered the deleter.</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;deleter_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">][</span><span class="s2">&quot;sub&quot;</span><span class="p">]</span>

        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">deleted_user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deleteduser_create</span><span class="p">(</span>
                <span class="n">deleted_user_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deleted_user</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DELETED_USER</span>
            <span class="k">return</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">deleted_user</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># deleteduser_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.deleteduser_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.deleteduser_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:deleteduser&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">deleteduser_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deleteduser_delete</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># deleteduser_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.deleteduser_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.deleteduser_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:deleteduser&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">deleteduser_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">deleted_user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deleteduser_read</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deleted_user</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DELETED_USER</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">deleted_user</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># deleteduser_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.deleteduser_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.deleteduser_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:deleteduser&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">deleteduser_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">deleted_user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deleteduser_update</span><span class="p">(</span>
                <span class="n">user_id</span><span class="p">,</span> <span class="n">deleted_user_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deleted_user</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DELETED_USER</span>
            <span class="k">return</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">deleted_user</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># deletedusersite_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.deletedusersite_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.deletedusersite_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:deletedusersite&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">deletedusersite_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param user_id (optional): string An optional query parameter to filter by user_id</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">deleted_user_sites</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deletedusersite_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deleted_user_sites</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DELETED_USER_SITE</span>
            <span class="n">deleted_user_sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">deleted_user_site</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
                                  <span class="k">for</span> <span class="n">deleted_user_site</span> <span class="ow">in</span> <span class="n">deleted_user_sites</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">deleted_user_sites</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># deletedusersite_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.deletedusersite_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.deletedusersite_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:deletedusersite&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">deletedusersite_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">deleted_user_site</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deletedusersite_create</span><span class="p">(</span>
                <span class="n">deleted_user_site_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deleted_user_site</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DELETED_USER_SITE</span>
            <span class="k">return</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">deleted_user_site</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># deletedusersite_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.deletedusersite_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.deletedusersite_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:deletedusersite&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">deletedusersite_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deletedusersite_delete</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># deletedusersite_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.deletedusersite_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.deletedusersite_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:deletedusersite&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">deletedusersite_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">deleted_user_site</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deletedusersite_read</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deleted_user_site</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DELETED_USER_SITE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">deleted_user_site</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># deletedusersite_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.deletedusersite_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.deletedusersite_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:deletedusersite&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">deletedusersite_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">deleted_user_site</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">deletedusersite_update</span><span class="p">(</span>
                <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">deleted_user_site_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deleted_user_site</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DELETED_USER_SITE</span>
            <span class="k">return</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">deleted_user_site</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># domainrole_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.domainrole_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.domainrole_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">domainrole_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param domain_id (optional): integer An optional query parameter to filter by domain_id</span>
<span class="sd">        :param role_id (optional): integer An optional query parameter to filter by role_id</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">domain_roles</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">domainrole_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">domain_roles</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DOMAIN_ROLE</span>
            <span class="n">domain_roles</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">domain_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">domain_role</span> <span class="ow">in</span> <span class="n">domain_roles</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">domain_roles</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># domainrole_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.domainrole_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.domainrole_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">domainrole_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">domain_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">domainrole_create</span><span class="p">(</span>
                <span class="n">domain_role_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">domain_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DOMAIN_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">domain_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># domainrole_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.domainrole_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.domainrole_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">domainrole_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">domainrole_delete</span><span class="p">(</span><span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># domainrole_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.domainrole_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.domainrole_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">domainrole_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">domain_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">domainrole_read</span><span class="p">(</span><span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">domain_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DOMAIN_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">domain_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># domainrole_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.domainrole_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.domainrole_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">domainrole_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">domain_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">domainrole_update</span><span class="p">(</span>
                <span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="n">domain_role_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">domain_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DOMAIN_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">domain_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># domain_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.domain_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.domain_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span>
                         <span class="n">allow_for_management_portal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">domain_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param parent_id (optional): integer An optional query parameter to filter by parent_id</span>
<span class="sd">        :param domain_ids (optional): array An optional list of domain ids</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">domains</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">domain_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">domains</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DOMAIN</span>
            <span class="n">domains</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">domain</span> <span class="ow">in</span> <span class="n">domains</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">domains</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># domain_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.domain_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.domain_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">domain_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">domain</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">domain_create</span><span class="p">(</span><span class="n">domain_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">domain</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DOMAIN</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># domain_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.domain_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.domain_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">domain_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">domain_delete</span><span class="p">(</span><span class="n">domain_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># domain_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.domain_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.domain_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span>
                         <span class="n">allow_for_management_portal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">domain_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">domain</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">domain_read</span><span class="p">(</span><span class="n">domain_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">domain</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DOMAIN</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># domain_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.domain_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.domain_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">domain_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">domain</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">domain_update</span><span class="p">(</span><span class="n">domain_id</span><span class="p">,</span>
                                                                           <span class="n">domain_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">domain</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">DOMAIN</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># healthcheck -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.healthcheck"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.healthcheck">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">healthcheck</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The healthcheck for the Management Layer simply returns a structure</span>
<span class="sd">        with the version, timestamp and host name.</span>
<span class="sd">        The health statuses of the backends have been included as well, although</span>
<span class="sd">        they have no effect on whether the management layer is considered healthy</span>
<span class="sd">        or not on its own.</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">access_control_health</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">healthcheck</span><span class="p">()</span>
            <span class="n">access_control_health</span> <span class="o">=</span> <span class="n">access_control_health</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;server_timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;db_timestamp&quot;</span><span class="p">]:</span>
                <span class="n">access_control_health</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">access_control_health</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">access_control_health</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">user_data_store_health</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">healthcheck</span><span class="p">()</span>
            <span class="n">user_data_store_health</span> <span class="o">=</span> <span class="n">user_data_store_health</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;server_timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;db_timestamp&quot;</span><span class="p">]:</span>
                <span class="n">user_data_store_health</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_data_store_health</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">user_data_store_health</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">AUTHENTICATION_SERVICE_API</span> <span class="o">+</span> <span class="s2">&quot;/healthcheck&quot;</span>
            <span class="k">async</span> <span class="k">with</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;client_session&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>
                <span class="n">authentication_service_health</span> <span class="o">=</span> <span class="k">await</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">authentication_service_health</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="n">socket</span><span class="o">.</span><span class="n">getfqdn</span><span class="p">(),</span>
            <span class="s2">&quot;server_timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">__version__</span><span class="p">,</span>
            <span class="s2">&quot;access_control_health&quot;</span><span class="p">:</span> <span class="n">access_control_health</span><span class="p">,</span>
            <span class="s2">&quot;user_data_store_health&quot;</span><span class="p">:</span> <span class="n">user_data_store_health</span><span class="p">,</span>
            <span class="s2">&quot;authentication_service_health&quot;</span><span class="p">:</span> <span class="n">authentication_service_health</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># invitationdomainrole_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitationdomainrole_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitationdomainrole_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitationdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitationdomainrole_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param invitation_id (optional): string An optional query parameter to filter by invitation_id</span>
<span class="sd">        :param domain_id (optional): integer An optional query parameter to filter by domain_id</span>
<span class="sd">        :param role_id (optional): integer An optional query parameter to filter by role_id</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">invitation_domain_roles</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitationdomainrole_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invitation_domain_roles</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">INVITATION_DOMAIN_ROLE</span>
            <span class="n">invitation_domain_roles</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">invitation_domain_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
                                       <span class="k">for</span> <span class="n">invitation_domain_role</span> <span class="ow">in</span> <span class="n">invitation_domain_roles</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">invitation_domain_roles</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># invitationdomainrole_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitationdomainrole_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitationdomainrole_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitationdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="nd">@requester_has_role</span><span class="p">(</span><span class="n">body_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitationdomainrole_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">invitation_domain_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitationdomainrole_create</span><span class="p">(</span>
                <span class="n">invitation_domain_role_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invitation_domain_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">INVITATION_DOMAIN_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">invitation_domain_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># invitationdomainrole_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitationdomainrole_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitationdomainrole_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitationdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="nd">@requester_has_role</span><span class="p">(</span><span class="n">target_invitation_id_field</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">domain_id_field</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">role_id_field</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitationdomainrole_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">invitation_id</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param invitation_id: string A UUID value identifying the invitation.</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitationdomainrole_delete</span><span class="p">(</span>
                <span class="n">invitation_id</span><span class="o">=</span><span class="n">invitation_id</span><span class="p">,</span> <span class="n">domain_id</span><span class="o">=</span><span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="o">=</span><span class="n">role_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># invitationdomainrole_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitationdomainrole_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitationdomainrole_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitationdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitationdomainrole_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">invitation_id</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param invitation_id: string A UUID value identifying the invitation.</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">invitation_domain_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitationdomainrole_read</span><span class="p">(</span>
                <span class="n">invitation_id</span><span class="o">=</span><span class="n">invitation_id</span><span class="p">,</span> <span class="n">domain_id</span><span class="o">=</span><span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="o">=</span><span class="n">role_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invitation_domain_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">INVITATION_DOMAIN_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">invitation_domain_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># invitation_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitation_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitation_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitation&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitation_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param invitor_id (optional): string Optional filter based on the invitor (the user who created the invitation)</span>
<span class="sd">        :param invitation_ids (optional): array An optional list of invitation ids</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">invitations</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitation_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invitations</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">INVITATION</span>
            <span class="n">invitations</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">invitation</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">invitation</span> <span class="ow">in</span> <span class="n">invitations</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">invitations</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># invitation_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitation_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitation_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitation&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitation_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The caller of this function is considered the invitor.</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;invitor_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">][</span><span class="s2">&quot;sub&quot;</span><span class="p">]</span>

        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">invitation</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitation_create</span><span class="p">(</span>
                <span class="n">invitation_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invitation</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">INVITATION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">invitation</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># invitation_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitation_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitation_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitation&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitation_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">invitation_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param invitation_id: string A UUID value identifying the invitation.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitation_delete</span><span class="p">(</span><span class="n">invitation_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># invitation_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitation_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitation_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitation&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitation_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">invitation_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param invitation_id: string A UUID value identifying the invitation.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">invitation</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitation_read</span><span class="p">(</span><span class="n">invitation_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invitation</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">INVITATION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">invitation</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># invitation_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitation_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitation_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitation&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitation_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">invitation_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param invitation_id: string A UUID value identifying the invitation.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">invitation</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitation_update</span><span class="p">(</span>
                <span class="n">invitation_id</span><span class="p">,</span> <span class="n">invitation_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invitation</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">INVITATION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">invitation</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># invitation_send -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitation_send"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitation_send">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitation&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitation_send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">invitation_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param invitation_id: string</span>
<span class="sd">        :param language (optional): string</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">language</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="s2">&quot;en&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="c1"># Note that invitations are sent by the Authentication Service and not</span>
            <span class="c1"># the Access Control component.</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitation_send</span><span class="p">(</span><span class="n">invitation_id</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># purge_expired_invitations -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.purge_expired_invitations"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.purge_expired_invitations">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">any</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># Tech admin only</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">purge_expired_invitations</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param synchronous_mode (optional): boolean Change the mode of the call to synchronous.</span>
<span class="sd">        :param cutoff_date (optional): string An optional cutoff date to purge invites before this date</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">synchronous_mode</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;synchronous_mode&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">cutoff_date</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cutoff_date&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">request_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;cutoff_date&quot;</span><span class="p">:</span> <span class="n">cutoff_date</span>
            <span class="p">}</span> <span class="k">if</span> <span class="n">cutoff_date</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="n">api</span> <span class="o">=</span> <span class="s2">&quot;operational_api&quot;</span> <span class="k">if</span> <span class="n">synchronous_mode</span> <span class="k">else</span> <span class="s2">&quot;authentication_service_api&quot;</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="n">api</span><span class="p">]</span><span class="o">.</span><span class="n">purge_expired_invitations</span><span class="p">(</span><span class="o">**</span><span class="n">request_kwargs</span><span class="p">)</span>
            <span class="n">purged_invitations</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">if</span> <span class="n">synchronous_mode</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="n">purged_invitations</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;synchronous&quot;</span> <span class="k">if</span> <span class="n">synchronous_mode</span> <span class="k">else</span> <span class="s2">&quot;asynchronous&quot;</span>
            <span class="k">return</span> <span class="n">purged_invitations</span></div>

    <span class="c1"># invitationsiterole_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitationsiterole_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitationsiterole_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitationsiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitationsiterole_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param invitation_id (optional): string An optional query parameter to filter by invitation_id</span>
<span class="sd">        :param site_id (optional): integer An optional query parameter to filter by site_id</span>
<span class="sd">        :param role_id (optional): integer An optional query parameter to filter by role_id</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">invitation_site_roles</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitationsiterole_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invitation_site_roles</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">INVITATION_SITE_ROLE</span>
            <span class="n">invitation_site_roles</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">invitation_site_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
                                     <span class="k">for</span> <span class="n">invitation_site_role</span> <span class="ow">in</span> <span class="n">invitation_site_roles</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">invitation_site_roles</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># invitationsiterole_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitationsiterole_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitationsiterole_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitationsiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="nd">@requester_has_role</span><span class="p">(</span><span class="n">body_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitationsiterole_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">invitation_site_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitationsiterole_create</span><span class="p">(</span><span class="n">invitation_site_role_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invitation_site_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">INVITATION_SITE_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">invitation_site_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># invitationsiterole_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitationsiterole_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitationsiterole_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitationsiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="nd">@requester_has_role</span><span class="p">(</span><span class="n">target_invitation_id_field</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">site_id_field</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">role_id_field</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitationsiterole_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">invitation_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param invitation_id: string A UUID value identifying the invitation.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitationsiterole_delete</span><span class="p">(</span>
                <span class="n">invitation_id</span><span class="o">=</span><span class="n">invitation_id</span><span class="p">,</span> <span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="o">=</span><span class="n">role_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># invitationsiterole_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.invitationsiterole_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.invitationsiterole_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:invitationsiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">invitationsiterole_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">invitation_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param invitation_id: string A UUID value identifying the invitation.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">invitation_site_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">invitationsiterole_read</span><span class="p">(</span>
                <span class="n">invitation_id</span><span class="o">=</span><span class="n">invitation_id</span><span class="p">,</span> <span class="n">site_id</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="o">=</span><span class="n">role_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">invitation_site_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">INVITATION_SITE_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">invitation_site_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># get_all_user_roles -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_all_user_roles"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_all_user_roles">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:userdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:usersiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">],</span> <span class="n">target_user_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_all_user_roles</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">user_roles</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_all_user_roles</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">user_roles</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span></div>

    <span class="c1"># get_domain_roles -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_domain_roles"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_domain_roles">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_domain_roles</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">domain_roles</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_domain_roles</span><span class="p">(</span><span class="n">domain_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">domain_roles</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span></div>

    <span class="c1"># get_site_from_client_token_id -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_site_from_client_token_id"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_site_from_client_token_id">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="c1"># The permission is checked in the function and not via a decorator.</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_site_from_client_token_id</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">client_token_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param client_token_id: string A client token id. This is not the primary key of the client table, but rather the client id that is typically configured along with the client secret.</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># In order to be allowed to request the site info for a particular client ID, the client ID</span>
        <span class="c1"># needs to be the audience of the JWT token used to make the request.</span>
        <span class="k">if</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">][</span><span class="s2">&quot;aud&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">client_token_id</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">JSONForbidden</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Token client id must match the one used in the API call&quot;</span><span class="p">)</span>

        <span class="n">nocache</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nocache&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nocache</span><span class="p">:</span>
            <span class="c1"># When nocache is set, we perform all the lookups via the API.</span>
            <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="p">[</span><span class="n">client</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">client_list</span><span class="p">(</span>
                        <span class="n">client_token_id</span><span class="o">=</span><span class="n">client_token_id</span><span class="p">)</span>
                    <span class="p">[</span><span class="n">site</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">site_list</span><span class="p">(</span><span class="n">client_id</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                    <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">JSONNotFound</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">site_id</span> <span class="o">=</span> <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">site_id_for</span><span class="p">(</span><span class="n">client_token_id</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">site_by_id</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">JSONNotFound</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># get_sites_under_domain -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_sites_under_domain"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_sites_under_domain">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span>
                         <span class="n">allow_for_management_portal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_sites_under_domain</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">sites</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_sites_under_domain</span><span class="p">(</span><span class="n">domain_id</span><span class="p">)</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">sites</span><span class="p">]</span></div>

    <span class="c1"># get_site_and_domain_roles -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_site_and_domain_roles"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_site_and_domain_roles">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_site_and_domain_roles</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">site_and_domain_roles</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_site_and_domain_roles</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">site_and_domain_roles</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span></div>

    <span class="c1"># get_site_role_labels_aggregated -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_site_role_labels_aggregated"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_site_role_labels_aggregated">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_site_role_labels_aggregated</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">site_role_labels_aggregated</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_site_role_labels_aggregated</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">site_role_labels_aggregated</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span></div>

    <span class="c1"># get_user_domain_permissions -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_user_domain_permissions"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_user_domain_permissions">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:permission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:resource&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:roleresourcepermission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">],</span> <span class="n">target_user_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_user_domain_permissions</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">JSONBadRequest</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Malformed user id&quot;</span><span class="p">)</span>

        <span class="n">nocache</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nocache&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">roles_for_domain</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_user_roles_for_domain</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span>
                                                                 <span class="n">nocache</span><span class="o">=</span><span class="n">nocache</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">roles_for_domain</span><span class="p">:</span>
            <span class="n">tech_admin_role_id</span> <span class="o">=</span> <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">role_id_for</span><span class="p">(</span><span class="n">TECH_ADMIN_ROLE_LABEL</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">tech_admin_role_id</span> <span class="ow">in</span> <span class="n">roles_for_domain</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">all_resource_permissions</span><span class="p">()</span>
                <span class="c1"># There is also an API call that can be used, if necessary:</span>
                <span class="c1"># resource_permissions = await request.app[</span>
                <span class="c1">#     &quot;operational_api&quot;].get_tech_admin_resource_permissions()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
                    <span class="n">resource_permissions</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                        <span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_resource_permissions_for_roles</span><span class="p">(</span>
                            <span class="n">role_ids</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">roles_for_domain</span><span class="p">))</span>

                <span class="c1"># Resource permissions are presented as a concatenation of the resource URN, a semicolon</span>
                <span class="c1"># and the permission name. The API calls above return identifiers, so we need to map it.</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">resource_urn_for</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">resource_id</span><span class="p">),</span>
                                   <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">permission_name_for</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">permission_id</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">rp</span> <span class="ow">in</span> <span class="n">resource_permissions</span>
                <span class="p">]</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># user_has_permissions -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.user_has_permissions"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.user_has_permissions">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:userdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:usersiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:permission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:resource&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">],</span> <span class="n">target_user_field</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">user_has_permissions</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The request body uses strings to identify resources and permissions.</span>
        <span class="c1"># We convert it to their integer representations here as a validation step.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">resource_permissions</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">resource_id_for</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;resource&quot;</span><span class="p">]),</span>
                 <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">permission_id_for</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;permission&quot;</span><span class="p">]))</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">body</span><span class="p">[</span><span class="s2">&quot;resource_permissions&quot;</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">JSONBadRequest</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

        <span class="n">nocache</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nocache&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">operator_string</span> <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="s2">&quot;operator&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">operator_string</span> <span class="o">==</span> <span class="s2">&quot;any&quot;</span><span class="p">:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="nb">any</span>
        <span class="k">elif</span> <span class="n">operator_string</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="nb">all</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">JSONBadRequest</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;Invalid operator specified: </span><span class="si">{operator_string}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="n">site_id</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;site_id&quot;</span><span class="p">)</span>
        <span class="n">domain_id</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;domain_id&quot;</span><span class="p">)</span>

        <span class="c1"># Either a site_id or domain_id needs to be specified.</span>
        <span class="k">if</span> <span class="n">site_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">domain_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> \
           <span class="n">site_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">domain_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">JSONBadRequest</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Either site_id or domain_id needs to be specified&quot;</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utils</span><span class="o">.</span><span class="n">user_has_permissions</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">resource_permissions</span><span class="p">,</span>
                                                  <span class="n">site</span><span class="o">=</span><span class="n">site_id</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain_id</span><span class="p">,</span> <span class="n">nocache</span><span class="o">=</span><span class="n">nocache</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;has_permissions&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">}</span></div>

    <span class="c1"># get_user_management_portal_permissions -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_user_management_portal_permissions"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_user_management_portal_permissions">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:permission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:resource&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:roleresourcepermission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">],</span> <span class="n">target_user_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_user_management_portal_permissions</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">][</span><span class="s2">&quot;aud&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">MANAGEMENT_PORTAL_CLIENT_ID</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">JSONForbidden</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Only the Management Portal can use this API call&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">JSONBadRequest</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Malformed user id&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">management_portal_site_id</span> <span class="o">=</span> <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">site_id_for</span><span class="p">(</span><span class="n">MANAGEMENT_PORTAL_CLIENT_ID</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">JSONBadRequest</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Misconfigured Management Portal Client ID&quot;</span><span class="p">)</span>

        <span class="n">nocache</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nocache&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">roles</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_user_roles_for_site</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">management_portal_site_id</span><span class="p">,</span>
                                                    <span class="n">nocache</span><span class="o">=</span><span class="n">nocache</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">roles</span><span class="p">:</span>
            <span class="c1"># No roles are linked to the user for the Management Portal</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">tech_admin_role_id</span> <span class="o">=</span> <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">role_id_for</span><span class="p">(</span><span class="n">TECH_ADMIN_ROLE_LABEL</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tech_admin_role_id</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">all_resource_permissions</span><span class="p">()</span>
            <span class="c1"># There is also an API call that can be used, if necessary:</span>
            <span class="c1"># resource_permissions = await request.app[</span>
            <span class="c1">#     &quot;operational_api&quot;].get_tech_admin_resource_permissions()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
                <span class="n">resource_permissions</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                    <span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_resource_permissions_for_roles</span><span class="p">(</span><span class="n">role_ids</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">roles</span><span class="p">))</span>

                <span class="c1"># Resource permissions are presented as a concatenation of the resource URN, a semicolon</span>
                <span class="c1"># and the permission name. The API calls above return identifiers, so we need to map it.</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">resource_urn_for</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">resource_id</span><span class="p">),</span>
                                   <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">permission_name_for</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">permission_id</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">rp</span> <span class="ow">in</span> <span class="n">resource_permissions</span>
                <span class="p">]</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># get_user_site_permissions -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_user_site_permissions"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_user_site_permissions">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:permission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:resource&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:roleresourcepermission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">],</span> <span class="n">target_user_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_user_site_permissions</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">JSONBadRequest</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Malformed user id&quot;</span><span class="p">)</span>

        <span class="n">nocache</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nocache&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">roles_for_site</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_user_roles_for_site</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span>
                                                             <span class="n">nocache</span><span class="o">=</span><span class="n">nocache</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">roles_for_site</span><span class="p">:</span>
            <span class="n">tech_admin_role_id</span> <span class="o">=</span> <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">role_id_for</span><span class="p">(</span><span class="n">TECH_ADMIN_ROLE_LABEL</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">tech_admin_role_id</span> <span class="ow">in</span> <span class="n">roles_for_site</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">all_resource_permissions</span><span class="p">()</span>
                <span class="c1"># There is also an API call that can be used, if necessary:</span>
                <span class="c1"># resource_permissions = await request.app[</span>
                <span class="c1">#     &quot;operational_api&quot;].get_tech_admin_resource_permissions()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
                    <span class="n">resource_permissions</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                        <span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_resource_permissions_for_roles</span><span class="p">(</span>
                            <span class="n">role_ids</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">roles_for_site</span><span class="p">))</span>

                <span class="c1"># Resource permissions are presented as a concatenation of the resource URN, a semicolon</span>
                <span class="c1"># and the permission name. The API calls above return identifiers, so we need to map it.</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">resource_urn_for</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">resource_id</span><span class="p">),</span>
                                   <span class="n">mappings</span><span class="o">.</span><span class="n">Mappings</span><span class="o">.</span><span class="n">permission_name_for</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">permission_id</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">rp</span> <span class="ow">in</span> <span class="n">resource_permissions</span>
                <span class="p">]</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># get_user_site_role_labels_aggregated -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_user_site_role_labels_aggregated"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_user_site_role_labels_aggregated">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:userdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:usersiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">],</span> <span class="n">target_user_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_user_site_role_labels_aggregated</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">user_site_role_labels_aggregated</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_user_site_role_labels_aggregated</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">user_site_role_labels_aggregated</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span></div>

    <span class="c1"># get_users_with_roles_for_domain -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_users_with_roles_for_domain"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_users_with_roles_for_domain">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:userdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_users_with_roles_for_domain</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="c1"># Get access control response.</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_users_with_roles_for_domain</span><span class="p">(</span><span class="n">domain_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">transform_users_with_roles</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="c1"># get_users_with_roles_for_site -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.get_users_with_roles_for_site"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.get_users_with_roles_for_site">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:domain&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:domainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:userdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                               <span class="p">(</span><span class="s2">&quot;urn:ge:access_control:usersiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_users_with_roles_for_site</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="c1"># Get access control response.</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;operational_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_users_with_roles_for_site</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">transform_users_with_roles</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="c1"># organisation_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.organisation_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.organisation_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="c1"># No permissions are required for this</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">organisation_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param organisation_ids (optional): array An optional list of organisation ids</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">organisations</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">organisation_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">organisations</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ORGANISATION</span>
            <span class="n">organisations</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">organisation</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
                             <span class="k">for</span> <span class="n">organisation</span> <span class="ow">in</span> <span class="n">organisations</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">organisations</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># organisation_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.organisation_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.organisation_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">organisation_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">organisation</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">organisation_create</span><span class="p">(</span>
                <span class="n">organisation_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">organisation</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ORGANISATION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">organisation</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># organisation_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.organisation_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.organisation_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">organisation_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">organisation_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param organisation_id: integer An integer identifying an organisation</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">organisation_delete</span><span class="p">(</span>
                <span class="n">organisation_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># organisation_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.organisation_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.organisation_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="c1"># No permissions are required for this</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">organisation_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">organisation_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param organisation_id: integer An integer identifying an organisation</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">organisation</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">organisation_read</span><span class="p">(</span>
                <span class="n">organisation_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">organisation</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ORGANISATION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">organisation</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># organisation_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.organisation_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.organisation_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">organisation_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">organisation_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param organisation_id: integer An integer identifying an organisation</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">organisation</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">organisation_update</span><span class="p">(</span>
                <span class="n">organisation_id</span><span class="o">=</span><span class="n">organisation_id</span><span class="p">,</span>
                <span class="n">organisation_update</span><span class="o">=</span><span class="n">body</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">organisation</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ORGANISATION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">organisation</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># permission_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.permission_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.permission_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:permission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">permission_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param permission_ids (optional): array An optional list of permission ids</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">permissions</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">permission_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">permissions</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">PERMISSION</span>
            <span class="n">permissions</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">permission</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">permission</span> <span class="ow">in</span> <span class="n">permissions</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">permissions</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># permission_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.permission_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.permission_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:permission&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">permission_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">permission</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">permission_create</span><span class="p">(</span>
                <span class="n">permission_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">permission</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">PERMISSION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">permission</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># permission_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.permission_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.permission_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:permission&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">permission_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">permission_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param permission_id: integer A unique integer value identifying the permission.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">permission_delete</span><span class="p">(</span><span class="n">permission_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># permission_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.permission_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.permission_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:permission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">permission_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">permission_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param permission_id: integer A unique integer value identifying the permission.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">permission</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">permission_read</span><span class="p">(</span><span class="n">permission_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">permission</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">PERMISSION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">permission</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># permission_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.permission_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.permission_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:permission&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">permission_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">permission_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param permission_id: integer A unique integer value identifying the permission.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">permission</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">permission_update</span><span class="p">(</span><span class="n">permission_id</span><span class="p">,</span>
                                                                                   <span class="n">permission_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">permission</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">PERMISSION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">permission</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># refresh_all -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.refresh_all"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.refresh_all">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">any</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># Tech admin only</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">refresh_all</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">mappings</span><span class="o">.</span><span class="n">refresh_all</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span></div>

    <span class="c1"># refresh_clients -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.refresh_clients"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.refresh_clients">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">refresh_clients</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">mappings</span><span class="o">.</span><span class="n">refresh_clients</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span></div>

    <span class="c1"># refresh_domains -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.refresh_domains"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.refresh_domains">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">any</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># Tech admin only</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">refresh_domains</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">mappings</span><span class="o">.</span><span class="n">refresh_domains</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span></div>

    <span class="c1"># refresh_keys -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.refresh_keys"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.refresh_keys">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">refresh_keys</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">mappings</span><span class="o">.</span><span class="n">refresh_keys</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span></div>

    <span class="c1"># refresh_permissions -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.refresh_permissions"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.refresh_permissions">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">any</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># Tech admin only</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">refresh_permissions</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">mappings</span><span class="o">.</span><span class="n">refresh_permissions</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span></div>

    <span class="c1"># refresh_resources -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.refresh_resources"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.refresh_resources">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">any</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># Tech admin only</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">refresh_resources</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">mappings</span><span class="o">.</span><span class="n">refresh_resources</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span></div>

    <span class="c1"># refresh_roles -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.refresh_roles"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.refresh_roles">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">any</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># Tech admin only</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">refresh_roles</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">mappings</span><span class="o">.</span><span class="n">refresh_roles</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span></div>

    <span class="c1"># refresh_sites -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.refresh_sites"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.refresh_sites">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">any</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># Tech admin only</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">refresh_sites</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param nocache (optional): boolean An optional query parameter to instructing an API call to by pass caches when reading data.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">mappings</span><span class="o">.</span><span class="n">refresh_sites</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span></div>

    <span class="c1"># request_user_deletion -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.request_user_deletion"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.request_user_deletion">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">any</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># Tech admin only</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">request_user_deletion</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The caller of this function is considered the deleter.</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;deleter_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">][</span><span class="s2">&quot;sub&quot;</span><span class="p">]</span>

        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">request_user_deletion</span><span class="p">(</span>
                <span class="n">request_user_deletion</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># resource_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.resource_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.resource_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:resource&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">resource_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param prefix (optional): string An optional URN prefix filter</span>
<span class="sd">        :param resource_ids (optional): array An optional list of resource ids</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">resources</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resource_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">resources</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">RESOURCE</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">resources</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">resources</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># resource_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.resource_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.resource_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:resource&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">resource_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">resource</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resource_create</span><span class="p">(</span><span class="n">resource_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">resource</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">RESOURCE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># resource_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.resource_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.resource_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:resource&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">resource_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">resource_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param resource_id: integer A unique integer value identifying the resource.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resource_delete</span><span class="p">(</span><span class="n">resource_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># resource_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.resource_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.resource_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:resource&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">resource_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">resource_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param resource_id: integer A unique integer value identifying the resource.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">resource</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resource_read</span><span class="p">(</span><span class="n">resource_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">resource</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">RESOURCE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># resource_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.resource_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.resource_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:resource&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">resource_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">resource_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param resource_id: integer A unique integer value identifying the resource.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">resource</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resource_update</span><span class="p">(</span><span class="n">resource_id</span><span class="p">,</span>
                                                                               <span class="n">resource_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">resource</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">RESOURCE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># roleresourcepermission_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.roleresourcepermission_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.roleresourcepermission_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:roleresourcepermission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">roleresourcepermission_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param role_id (optional): integer An optional query parameter to filter by role_id</span>
<span class="sd">        :param resource_id (optional): integer An optional resource filter</span>
<span class="sd">        :param permission_id (optional): integer An optional permission filter</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">rrps</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">roleresourcepermission_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rrps</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ROLE_RESOURCE_PERMISSION</span>
            <span class="n">rrps</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">rrp</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">rrp</span> <span class="ow">in</span> <span class="n">rrps</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">rrps</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># roleresourcepermission_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.roleresourcepermission_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.roleresourcepermission_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:roleresourcepermission&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">roleresourcepermission_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">rrp</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">roleresourcepermission_create</span><span class="p">(</span>
                <span class="n">role_resource_permission_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rrp</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ROLE_RESOURCE_PERMISSION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">rrp</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># roleresourcepermission_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.roleresourcepermission_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.roleresourcepermission_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:roleresourcepermission&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">roleresourcepermission_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="n">resource_id</span><span class="p">,</span> <span class="n">permission_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :param resource_id: integer A unique integer value identifying the resource.</span>
<span class="sd">        :param permission_id: integer A unique integer value identifying the permission.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">access_control_roleresourcepermission_delete</span><span class="p">(</span>
                <span class="n">role_id</span><span class="p">,</span> <span class="n">resource_id</span><span class="p">,</span> <span class="n">permission_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># roleresourcepermission_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.roleresourcepermission_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.roleresourcepermission_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:roleresourcepermission&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">roleresourcepermission_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="n">resource_id</span><span class="p">,</span> <span class="n">permission_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :param resource_id: integer A unique integer value identifying the resource.</span>
<span class="sd">        :param permission_id: integer A unique integer value identifying the permission.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">rrp</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">roleresourcepermission_read</span><span class="p">(</span><span class="n">role_id</span><span class="p">,</span> <span class="n">resource_id</span><span class="p">,</span> <span class="n">permission_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rrp</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ROLE_RESOURCE_PERMISSION</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">rrp</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># role_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.role_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.role_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:role&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">role_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param role_ids (optional): array An optional list of role ids</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">roles</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">role_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">roles</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ROLE</span>
            <span class="n">roles</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">roles</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># role_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.role_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.role_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:role&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">role_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">role_create</span><span class="p">(</span><span class="n">role_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># role_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.role_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.role_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:role&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">role_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">role_delete</span><span class="p">(</span><span class="n">role_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># role_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.role_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.role_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:role&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">role_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">role_read</span><span class="p">(</span><span class="n">role_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># role_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.role_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.role_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:role&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">role_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">role_update</span><span class="p">(</span><span class="n">role_id</span><span class="p">,</span> <span class="n">role_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># sitedataschema_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.sitedataschema_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.sitedataschema_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:sitedataschema&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">sitedataschema_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param site_ids (optional): array An optional list of site ids</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">sdss</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sitedataschema_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sdss</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE_DATA_SCHEMA</span>
            <span class="n">sdss</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sds</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">sds</span> <span class="ow">in</span> <span class="n">sdss</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">sdss</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># sitedataschema_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.sitedataschema_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.sitedataschema_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:sitedataschema&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">sitedataschema_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">sds</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sitedataschema_create</span><span class="p">(</span>
                <span class="n">site_data_schema_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sds</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE_DATA_SCHEMA</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sds</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># sitedataschema_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.sitedataschema_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.sitedataschema_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:sitedataschema&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">sitedataschema_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sitedataschema_delete</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># sitedataschema_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.sitedataschema_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.sitedataschema_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:sitedataschema&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">sitedataschema_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">sds</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sitedataschema_read</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sds</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE_DATA_SCHEMA</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sds</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># sitedataschema_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.sitedataschema_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.sitedataschema_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:sitedataschema&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">sitedataschema_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">sds</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sitedataschema_update</span><span class="p">(</span>
                <span class="n">site_id</span><span class="p">,</span> <span class="n">site_data_schema_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sds</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE_DATA_SCHEMA</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sds</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># siterole_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.siterole_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.siterole_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">siterole_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param site_id (optional): integer An optional query parameter to filter by site_id</span>
<span class="sd">        :param role_id (optional): integer An optional query parameter to filter by role_id</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">site_roles</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">siterole_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_roles</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE_ROLE</span>
            <span class="n">site_roles</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">site_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">site_role</span> <span class="ow">in</span> <span class="n">site_roles</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">site_roles</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># siterole_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.siterole_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.siterole_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">siterole_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">site_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">siterole_create</span><span class="p">(</span>
                <span class="n">site_role_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">site_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># siterole_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.siterole_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.siterole_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">siterole_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">siterole_delete</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># siterole_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.siterole_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.siterole_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">siterole_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">site_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">siterole_read</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">site_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># siterole_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.siterole_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.siterole_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:siterole&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">siterole_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">site_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">siterole_update</span><span class="p">(</span>
                <span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="n">site_role_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">site_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># site_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.site_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.site_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span>
                         <span class="n">allow_for_management_portal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">site_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param site_ids (optional): array An optional list of site ids</span>
<span class="sd">        :param client_id (optional): integer An optional client id to filter on</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">sites</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">site_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sites</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE</span>
            <span class="n">sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">sites</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">sites</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># site_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.site_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.site_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">site_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">site</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">site_create</span><span class="p">(</span><span class="n">site_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># site_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.site_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.site_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">site_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">site_delete</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># site_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.site_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.site_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span>
                         <span class="n">allow_for_management_portal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">site_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">site</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">site_read</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># site_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.site_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.site_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:site&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">site_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">site</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">site_update</span><span class="p">(</span><span class="n">site_id</span><span class="p">,</span> <span class="n">site_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">site</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">SITE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># userdomainrole_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.userdomainrole_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.userdomainrole_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:userdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span>
                         <span class="n">target_user_field</span><span class="o">=</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">userdomainrole_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param user_id (optional): string An optional query parameter to filter by user_id</span>
<span class="sd">        :param domain_id (optional): integer An optional query parameter to filter by domain_id</span>
<span class="sd">        :param role_id (optional): integer An optional query parameter to filter by role_id</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">udrs</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">userdomainrole_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">udrs</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER_DOMAIN_ROLE</span>
            <span class="n">udrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">udr</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">udr</span> <span class="ow">in</span> <span class="n">udrs</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">udrs</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># userdomainrole_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.userdomainrole_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.userdomainrole_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:userdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="nd">@requester_has_role</span><span class="p">(</span><span class="n">body_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">userdomainrole_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">user_read</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">body</span><span class="p">[</span>
                <span class="s2">&quot;user_id&quot;</span><span class="p">])</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">JSONForbidden</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;The target user does not exist&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">organisation_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">JSONForbidden</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;The target user is not linked to an organisation&quot;</span><span class="p">)</span>

            <span class="n">user_domain_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">userdomainrole_create</span><span class="p">(</span>
                <span class="n">user_domain_role_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">user_domain_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER_DOMAIN_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">user_domain_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># userdomainrole_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.userdomainrole_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.userdomainrole_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:userdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="nd">@requester_has_role</span><span class="p">(</span><span class="n">target_user_id_field</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">domain_id_field</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">role_id_field</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">userdomainrole_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">userdomainrole_delete</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># userdomainrole_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.userdomainrole_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.userdomainrole_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:userdomainrole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span>
                         <span class="n">target_user_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">userdomainrole_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param domain_id: integer A unique integer value identifying the domain.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">udr</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">userdomainrole_read</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">domain_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">udr</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER_DOMAIN_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">udr</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># user_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.user_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.user_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:identity_provider:user&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">user_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param birth_date (optional): string An optional birth_date range filter</span>
<span class="sd">        :param country (optional): string An optional country filter</span>
<span class="sd">        :param date_joined (optional): string An optional date joined range filter</span>
<span class="sd">        :param email (optional): string An optional case insensitive email inner match filter</span>
<span class="sd">        :param email_verified (optional): boolean An optional email verified filter</span>
<span class="sd">        :param first_name (optional): string An optional case insensitive first name inner match filter</span>
<span class="sd">        :param gender (optional): string An optional gender filter</span>
<span class="sd">        :param is_active (optional): boolean An optional is_active filter</span>
<span class="sd">        :param last_login (optional): string An optional last login range filter</span>
<span class="sd">        :param last_name (optional): string An optional case insensitive last name inner match filter</span>
<span class="sd">        :param msisdn (optional): string An optional case insensitive MSISDN inner match filter</span>
<span class="sd">        :param msisdn_verified (optional): boolean An optional MSISDN verified filter</span>
<span class="sd">        :param nickname (optional): string An optional case insensitive nickname inner match filter</span>
<span class="sd">        :param organisation_id (optional): integer An optional filter on the organisation id</span>
<span class="sd">        :param updated_at (optional): string An optional updated_at range filter</span>
<span class="sd">        :param username (optional): string An optional case insensitive username inner match filter</span>
<span class="sd">        :param q (optional): string An optional case insensitive inner match filter across all searchable text fields</span>
<span class="sd">        :param tfa_enabled (optional): boolean An optional filter based on whether a user has 2FA enabled or not</span>
<span class="sd">        :param has_organisation (optional): boolean An optional filter based on whether a user belongs to an organisation or not</span>
<span class="sd">        :param order_by (optional): array Fields and directions to order by, e.g. &quot;-created_at,username&quot;. Add &quot;-&quot; in front of a field name to indicate descending order.</span>
<span class="sd">        :param user_ids (optional): array An optional list of user ids</span>
<span class="sd">        :param site_ids (optional): array An optional list of site ids</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">users</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">user_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">users</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER</span>
            <span class="n">users</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">users</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># user_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.user_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.user_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:identity_provider:user&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">user_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">user_delete</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># user_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.user_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.user_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:identity_provider:user&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span> <span class="n">target_user_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">user_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">user_read</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># user_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.user_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.user_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:identity_provider:user&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)],</span> <span class="n">target_user_field</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">user_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">user_update</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span>
                                                                               <span class="n">user_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># usersitedata_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.usersitedata_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.usersitedata_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:usersitedata&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span>
                         <span class="n">target_user_field</span><span class="o">=</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">usersitedata_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param user_id (optional): string An optional query parameter to filter by user_id</span>
<span class="sd">        :param site_id (optional): integer An optional query parameter to filter by site_id</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">usds</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">usersitedata_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">usds</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER_SITE_DATA</span>
            <span class="n">usds</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">usd</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">usd</span> <span class="ow">in</span> <span class="n">usds</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">usds</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># usersitedata_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.usersitedata_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.usersitedata_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:usersitedata&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="c1"># The targeted user should not be allowed to make this call. This is admin only.</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">usersitedata_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">usd</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">usersitedata_create</span><span class="p">(</span><span class="n">user_site_data_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">usd</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER_SITE_DATA</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">usd</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># usersitedata_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.usersitedata_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.usersitedata_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:usersitedata&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="c1"># The targeted user should not be allowed to make this call. This is admin only.</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">usersitedata_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">usersitedata_delete</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># usersitedata_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.usersitedata_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.usersitedata_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:usersitedata&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span> <span class="n">target_user_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">usersitedata_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">usd</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">usersitedata_read</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">usd</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER_SITE_DATA</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">usd</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># usersitedata_update -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.usersitedata_update"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.usersitedata_update">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:user_data:usersitedata&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">)])</span>
    <span class="c1"># The targeted user should not be allowed to make this call. This is admin only.</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">usersitedata_update</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">usd</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;user_data_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">usersitedata_update</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span>
                                                                         <span class="n">user_site_data_update</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">usd</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER_SITE_DATA</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">usd</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># usersiterole_list -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.usersiterole_list"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.usersiterole_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:usersiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span>
                         <span class="n">target_user_field</span><span class="o">=</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">usersiterole_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param offset (optional): integer An optional query parameter specifying the offset in the result set to start from.</span>
<span class="sd">        :param limit (optional): integer An optional query parameter to limit the number of results returned.</span>
<span class="sd">        :param user_id (optional): string An optional query parameter to filter by user_id</span>
<span class="sd">        :param site_id (optional): integer An optional query parameter to filter by site_id</span>
<span class="sd">        :param role_id (optional): integer An optional query parameter to filter by role_id</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">usrs</span><span class="p">,</span> <span class="n">_status</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span>
                <span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">usersiterole_list_with_http_info</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">usrs</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER_SITE_ROLE</span>
            <span class="n">usrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">usr</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">usr</span> <span class="ow">in</span> <span class="n">usrs</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">usrs</span><span class="p">,</span> <span class="p">{</span>
            <span class="n">TOTAL_COUNT_HEADER</span><span class="p">:</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CLIENT_TOTAL_COUNT_HEADER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="p">}</span></div>

    <span class="c1"># usersiterole_create -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.usersiterole_create"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.usersiterole_create">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:usersiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">)])</span>
    <span class="nd">@requester_has_role</span><span class="p">(</span><span class="n">body_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">usersiterole_create</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param body: dict A dictionary containing the parsed and validated body</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;authentication_service_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">user_read</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">body</span><span class="p">[</span>
                <span class="s2">&quot;user_id&quot;</span><span class="p">])</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">JSONForbidden</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;The target user does not exist&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">organisation_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">JSONForbidden</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;The target user is not linked to an organisation&quot;</span><span class="p">)</span>

            <span class="n">user_site_role</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">usersiterole_create</span><span class="p">(</span>
                <span class="n">user_site_role_create</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">user_site_role</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER_SITE_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">user_site_role</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># usersiterole_delete -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.usersiterole_delete"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.usersiterole_delete">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:usersiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)])</span>
    <span class="nd">@requester_has_role</span><span class="p">(</span><span class="n">target_user_id_field</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">site_id_field</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">role_id_field</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">usersiterole_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">usersiterole_delete</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1"># usersiterole_read -- Synchronisation point for meld</span>
<div class="viewcode-block" id="Implementation.usersiterole_read"><a class="viewcode-back" href="../../management_layer.html#management_layer.integration.Implementation.usersiterole_read">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@require_permissions</span><span class="p">(</span><span class="nb">all</span><span class="p">,</span> <span class="p">[(</span><span class="s2">&quot;urn:ge:access_control:usersiterole&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)],</span> <span class="n">target_user_field</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">usersiterole_read</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param request: An HttpRequest</span>
<span class="sd">        :param user_id: string A UUID value identifying the user.</span>
<span class="sd">        :param site_id: integer A unique integer value identifying the site.</span>
<span class="sd">        :param role_id: integer A unique integer value identifying the role.</span>
<span class="sd">        :returns: result or (result, headers) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">client_exception_handler</span><span class="p">():</span>
            <span class="n">usr</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">app</span><span class="p">[</span><span class="s2">&quot;access_control_api&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">usersiterole_read</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">site_id</span><span class="p">,</span> <span class="n">role_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">usr</span><span class="p">:</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">transformations</span><span class="o">.</span><span class="n">USER_SITE_ROLE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">usr</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="kc">None</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Girl Effect.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>